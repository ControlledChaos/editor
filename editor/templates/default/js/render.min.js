(function($) {
    $( "#effect" ).hide();
    $('.field_desc').livequery( function(){
      $(this).tooltip({
          html : true ,
          placement : "auto top" ,
      });
    })
    $('#key_module').keyup(function(){
      var filter = $(this).val(), count = 0;
      // Loop through the icon list
      $("#modules-tab-content .sed-module-pb").each(function(){

          // If the list item does not contain the text phrase fade it out
          //
          key = $(this).attr("sed-module-name");
          $parent = $(this).parent();
          if( filter != "" ){
            $('#other_modules_panel_items .heading-item').parent().hide();
            if ( key.search( new RegExp(filter, "i") ) < 0) {

              if( $(this).parents('#other_modules_panel_items').length > 0 )
                $parent.fadeOut();
              else
                if($parent.hasClass('highlight'))
                  $parent.removeClass('highlight');
            } else {

              if( $(this).parents('#other_modules_panel_items').length > 0 )
                $parent.show();
              else
                $parent.addClass('highlight');

                count++;
            }
          }else{
            $('#other_modules_panel_items .heading-item').parent().show();
            if($parent.hasClass('highlight'))
              $parent.removeClass('highlight');
            else
              $parent.show();
          }
      });
    });
    $( "#button" ).click(function() {
        $( "#effect" ).toggle("slide");
        if($( "#button span" ).hasClass('right-open')){
            $( "#button span" ).removeClass("right-open").addClass("left-open");
        }else if($( "#button span" ).hasClass('left-open')){
            $( "#button span" ).removeClass("left-open").addClass("right-open");
        }

    });


     $('#zmind-platte a.iconf2').click(function (e) {
          e.preventDefault();
          $( "#effect" ).show("slide");

          if($( "#button span" ).hasClass('right-open')){
              $( "#button span" ).removeClass("right-open").addClass("left-open");
          }
      });

    $(window).load(function(e){
         //alert( $(".index").css( "top" ) );
         //alert("h : " + $("#zmind-header").height());
         //$(".index").css( "top" , $("#zmind-header").height() + "px" );
         //$(".index").css( "bottom" , $("#zmind-footer").height() + "px" );
    })


   /*
    var h2 = $("#zmind-header").height();
    var h3 = $("#zmind-footer").height();

    $(window).load(function(e){
         var h1 = $(document).height();
         var h4 = h1 - ( h2 + h3 + 133);
         $("#myDiagram").height( h4 );

         var w1 = $("#main-box-zmind").width();
         var w2 = $("#zmind-platte").width();
         var w3 = w1 - w2;
         $("#myDiagram").width( w3 );
    });

    $(window).resize(function() {
         var h1 = $(document).height();
         var h4 = h1 - ( h2 + h3 + 133);
         $("#myDiagram").height( h4 );

         var w1 = $("#main-box-zmind").width();
         var w2 = $("#zmind-platte").width();
         var w3 = w1 - w2;
         $("#myDiagram").width( w3 );
    });

      /*
      /*

        var cls = $(this).attr("class");
        $
        $( this ).addClass("right-open").removeClass("left-open");
      */


      /*
     $( ".sed-dialog" ).dialog({
        autoOpen: false,
        width: 620,
        height: 550,
        buttons: {
          "Ok": function () {
            $(this).dialog("close");
          },
          "Cancel": function () {
            $(this).dialog("close");
          }
        }
    });

    $( ".customize-style" ).click(function() {
        var id = "#" + $(this).attr("sed-dialog");
        $( id ).dialog( "open" );
    });    */


   /*
      $(".ui-dialog").livequery(function(){
        var heightWindow = $(window).height(),
            widthWindow  = $(window).width(),
            height       =  heightWindow - 160;   console.log(heightWindow);  console.log(widthWindow);  console.log(height);

         if(heightWindow < 800 && heightWindow > 240 && widthWindow > 600){
        $(".ui-dialog-content").dialog({
            minWidth: 295,
            maxWidth: 295,
            width: 295,
            height: 650
        });
        }
      });       */


     $( ".sed-dialog-type2" ).dialog({
        autoOpen: false,
        minWidth: 295,
        maxWidth: 295,
        width: 295,
        height: 650
    });

    $( ".customize-style" ).click(function() {
        var id = "#" + $(this).attr("sed-dialog");
        $( id ).dialog( "open" );
    });

     /*
     $( ".sed-dialog-type3" ).dialog({
        autoOpen: false,
        width: 290,
        height: 350,
        buttons: {
          "Ok": function () {
            $(this).dialog("close");
          }
        }
    });

    $( ".customize-style" ).click(function() {
        var id = "#" + $(this).attr("sed-dialog-type3");
        $( id ).dialog( "open" );
    });



         $( ".sed-dialog-type4" ).dialog({
        dialogClass: "library-dialog",
        autoOpen: false,
        width: 850,
        height: 560,
        buttons: {
          "Insert": function () {
            $(this).dialog("close");
          }
        }
    });

    $( ".customize-style" ).click(function() {
        var id = "#" + $(this).attr("sed-dialog-type4");
        $( id ).dialog( "open" );
    });      */

    $('.dropdown-toggle').dropdown();

    /*
      $('#zmind-footer .iconf').tooltip({
     placement:"top"
     });
     $('#zmind-header .iconf').tooltip({
     placement:"bottom"
     });
     $('.iconf2').tooltip({
     placement:"right"
     });
     $('.iconf3').tooltip({
     placement:"bottom"
     });  */
        //####### Menu
            $( ".menu" ).hide();
           $( window ).click(function(e) {
            //$( ".menu" ).hide();
           });
           $(".menu").menu();
            $( ".menu_item " ).click(function() {
                  $( this ).next().toggle( );
            });

/* tab  */
     $('#myTab3 div a').click(function (e) {
          e.preventDefault();
         $(this).tab('show');
      });
     $('#zmind-platte a').click(function (e) {
          e.preventDefault();
         $(this).tab('show');
      });

      $('#myTab a').click(function (e) {
          e.preventDefault();
          $(this).tab('show');
    });


    $('.btn-popover').popover('hide');
        $( "#opener2" ).click(function() {
        $( "#dialog2" ).dialog( "open" );
    });


    $( "#dialog2" ).dialog({
        autoOpen: false,
        modal: true,
        width: 700,
        height: 600,
        buttons: {
          "Ok": function () {
            $(this).dialog("close");
          },
          "Cancel": function () {
            $(this).dialog("close");
          }
        }
    });


    $( "#opener2" ).click(function() {
        $( "#dialog2" ).dialog( "open" );
    });


    $(".content").mCustomScrollbar({
        //autoHideScrollbar:true ,
        advanced:{
            updateOnBrowserResize:true, /*update scrollbars on browser resize (for layouts based on percentages): boolean*/
            updateOnContentResize:true,
        },
        callbacks:{
            onOverflowY:function(){
               $(this).find(".mCSB_container").addClass("mCSB_ctn_margin");
            },

            onOverflowYNone:function(){
              $(this).find(".mCSB_container").removeClass("mCSB_ctn_margin");
            }
        }
    });

    /*
    $('#myDropdown').on('hide.bs.dropdown', function () {

    });
    */


     $('.ui-spinner-input').livequery(function(){
            icons = {
                down: "icon-expand-less",
                up: "icon-expand-more"
            };
          var spinner = $(this).spinner({
            icons:          icons,
          });
      });

    $("select.custom-select").livequery(function(){
        $(this).chosen({
            disable_search_threshold: 5,
            no_results_text: "Oops, nothing found!",
            allow_single_deselect: true,
            placeholder_text_multiple: "Select Some Options",
            placeholder_text_single: "Select an Option",
            width: "95%"
        });
    });

    $( ".datepicker" ).datepicker({
        showOn: "button",
        buttonText: ""
    });

     /*
     $(function() {
        $.ajaxSetup({
            error: function(jqXHR, exception) {
                if (jqXHR.status === 0) {
                    alert('Not connect.\n Verify Network.');
                } else if (jqXHR.status == 404) {
                    alert('Requested page not found. [404]');
                } else if (jqXHR.status == 500) {
                    alert('Internal Server Error [500].');
                } else if (exception === 'parsererror') {
                    alert('Requested JSON parse failed.');
                } else if (exception === 'timeout') {
                    alert('Time out error.');
                } else if (exception === 'abort') {
                    alert('Ajax request aborted.');
                } else {
                    alert('Uncaught Error.\n' + jqXHR.responseText);
                }
            }
        });
    });    */



    var addGroupToModulesPanel = function ( label , type ){
        var html = $("#tmpl-" + type + "-group-panel").html();
        html = html.replace("{{GroupLabel}}" , label);
        var group = $( html ).appendTo( $("#other_" + type + "_panel_items") );
        return group;
    };

    var createOtherPanel = function( type ){

        var $tb_content_width = $("#" + type + "-tab-content > .tab_inner").width() ,
            $width   = 0 ,
            $last_i  = 0 ,
            $last_i2 = 0 ,
            $tb_content_children_length = $("#" + type + "-tab-content .tab_inner_content").children(".element_group").length ,
            $wspr = $("#" + type + "-tab-content > .tab_inner .spr").outerWidth(),
            $wtd = $("#" + type + "-tab-content .iconz_table > tbody > tr > td").outerWidth(),
            $groups = $("#" + type + "-tab-content > .tab_inner   .element_group") ;

        $groups.each(function(index , element){
            var $i_width = $(this).outerWidth( true );
            $width += $i_width + $wspr;
            if($width >= $tb_content_width ){
                $mode = ( ($width - $wspr) == $tb_content_width) ? 1:2;
                $last_i = index;
                $last_i_width = $i_width;
                return false;
            }
        });
        $last_i2 = ($last_i * 2) - 1;

        $width -= $wspr;

        if( $last_i == ($tb_content_children_length - 1) && $width == $tb_content_width)
            return ;



        if($last_i <= ($tb_content_children_length - 1) && $width >= $tb_content_width){
            $('#other_' + type + '_panel').show();
            if($mode == 2){
                var w1 = $width - $tb_content_width , w2 = $last_i_width - w1 ,
                    lastChildVisible = Math.floor( w2 / $wtd ) - 1,
                    $dGroup = $groups.eq($last_i),
                    group = addGroupToModulesPanel( $dGroup.attr("data-group-label") , type ),
                    moduleItems = group.find(".module-items") ,
                    $moved = 0;

                    $dGroup.find(".iconz_table > tbody > tr > td").each(function(itd , vtd){
                        if(itd > lastChildVisible){
                            $moved++;
                            var $li = $("<li></li>").appendTo( moduleItems );
                            $(this).find(".sed-module-pb").appendTo( $li );
                        }
                    });

                    if( $moved == $dGroup.find(".iconz_table > tbody > tr > td").length ){
                        $dGroup.prev().hide();
                        $dGroup.hide();
                    }

                    $dGroup.next().hide();


            }

            if($last_i < ($tb_content_children_length - 1) ){
                $groups.each(function(index , element){
                   if(index > $last_i){
                      var group = addGroupToModulesPanel( $(this).attr("data-group-label") , type ),
                          moduleItems = group.find(".module-items");

                      $(this).find(".iconz_table > tbody > tr > td").each(function(itd , vtd){

                         var $li = $("<li></li>").appendTo( moduleItems );
                         $(this).find(".sed-module-pb").appendTo( $li );

                      });

                      $(this).hide();
                      $(this).next().hide();

                   }
                });
            }

        }

    };

    var initializ_modules_tab = false;
    //other modules panel
    $('#myTab #modules a').on('shown.bs.tab', function (e) {

        if( initializ_modules_tab === false){
            createOtherPanel( "modules" );
            initializ_modules_tab = true;
        }

    });

    var initializ_widgets_tab = false;
    //other modules panel
    $('#myTab #widgets a').on('shown.bs.tab', function (e) {

        if( initializ_widgets_tab === false){
            createOtherPanel( "widgets" );
            initializ_widgets_tab = true;
        }

    });


    $( "#other-modules-toggle" ).click(function() {
        $( ".dropdown-other-modules" ).toggle( "slow" , "linear" );
    });

    $( "#other-widgets-toggle" ).click(function() {
        $( ".dropdown-other-widgets" ).toggle( "slow" , "linear" );
    });

 /*   $(".arrow-font-icon").livequery(function(){
                  $(this).click(function(e){
                      $(this).parent().next().toggle("slow");

                      if($(this).hasClass("default-angle-down")){
                          $(this).addClass("default-angle-right");
                          $(this).removeClass("default-angle-down");
                      }else{
                          $(this).addClass("default-angle-down");
                          $(this).removeClass("default-angle-right");
                      }
                  });
              });          */


    $( ".slider" ).slider();





$("#transform-dialog").dialog({
    autoOpen: false,
    width: 'auto', // overcomes width:'auto' and maxWidth bug
    maxWidth: 900,
    height: 'auto',
    modal: true,
    fluid: true, //new option
    resizable: false
});

    $( ".transform-dialog" ).click(function() {
        $( "#transform-dialog" ).dialog( "open" );
    });
/*
// on window resize run function
$(window).resize(function () {
    fluidDialog();
});

// catch dialog if opened within a viewport smaller than the dialog width
$(document).on("dialogopen", ".ui-dialog", function (event, ui) {
    fluidDialog();
});

function fluidDialog() {
    var $visible = $(".ui-dialog:visible");
    // each open dialog
    $visible.each(function () {
        var $this = $(this);
        var dialog = $this.find(".ui-dialog-content").data("ui-dialog");
        // if fluid option == true
        if (dialog.options.fluid) {
            var wWidth = $(window).width();
            // check window width against dialog width
            if (wWidth < (parseInt(dialog.options.maxWidth) + 50))  {
                // keep dialog from filling entire screen
                $this.css("max-width", "90%");
            } else {
                // fix maxWidth bug
                $this.css("max-width", dialog.options.maxWidth + "px");
            }
            //reposition dialog
            dialog.option("position", dialog.options.position);
        }
    });

}
*/


    $( "#transition-dialog" ).dialog({
        autoOpen: false,
        minWidth: 295,
        maxWidth: 295,
        width: 295,
        height: 350
    });


    $( ".transition-dialog" ).click(function() {
        $( "#transition-dialog" ).dialog( "open" );
    });

    $( "#box-shadow-dialog" ).dialog({
        autoOpen: false,
        minWidth: 295,
        maxWidth: 295,
        width: 295,
        height: 350
    });


    $( ".box-shadow-dialog" ).click(function() {
        $( "#box-shadow-dialog" ).dialog( "open" );
    });

    $( "#text-shadow-dialog" ).dialog({
        autoOpen: false,
        minWidth: 295,
        maxWidth: 295,
        width: 295,
        height: 350
    });


    $( ".text-shadow-dialog" ).click(function() {
        $( "#text-shadow-dialog" ).dialog( "open" );
    });

    $( "#gradient-dialog" ).dialog({
        autoOpen: false,
        minWidth: 295,
        maxWidth: 295,
        width: 295,
        height: 350,
        position: {
          my: "right bottom",
          at: "right top+160",
          of: window
          } ,
        buttons: {
          "Ok": function () {
            $(this).dialog("close");
          },
          "Cancel": function () {
            $(this).dialog("close");
          }
        }
    });


    $( ".gradient-dialog" ).click(function() {
        $( "#gradient-dialog" ).dialog( "open" );
    });



    $( "#style-editor-dialog" ).dialog({
        autoOpen: false,
        minWidth: 295,
        maxWidth: 295,
        width: 295,
        height: 350

    });

    $( ".style-editor-dialog" ).click(function() {
        $( "#style-editor-dialog" ).dialog( "open" );
    });




   /*	var _setDialogSize  = function(){
       var elDialog         =  $(".ui-dialog"),
           dialogScrollbar  =  elDialog.find(".mCustomScrollbar"),
           dialogContent    =  elDialog.find(".ui-dialog-content"),
           elDialogH        =  elDialog.height(),
           dialogScrollbarH =  dialogScrollbar.height(),
           dialogContentH   =  dialogContent.height(),
           height           = $(window).height();  console.log(elDialogH);console.log(dialogScrollbarH);console.log(dialogContentH);
                                                   console.log(height);console.log(dialogScrollbar);
       if(elDialogH >= height ){
           var elDialogHT       = elDialogH - height - 10 ,
               dialogScrollbarHT= dialogScrollbarH - elDialogHT ,
               dialogContentHT  = dialogContentH - elDialogHT;
       }
             console.log(elDialogHT);console.log(dialogScrollbarHT);console.log(dialogContentHT);
          elDialog.css({
          	maxHeight		: height -10,
          });

          dialogScrollbar.css({
          	height		: dialogScrollbarHT,
          });

          dialogContent.css({
          	height		: dialogContentHT,
          });
           console.log();console.log();console.log();
	};

    _setDialogSize();

  	$(window).resize(function( event ) {
          _setDialogSize();
	}); */


    $(".sed-bp-form-datepicker").livequery(function(){
        $(this).datetimepicker({
	        timeFormat: 'HH:mm:ss',
            dateFormat : "yy-mm-dd"
        });
    });


    $( ".mode-play-style" ).livequery(function(){
        $(this).accordion({
            active: 0,
            collapsible: true,
            event: 'click',
            heightStyle: 'content',
        });
    });




})(jQuery);

