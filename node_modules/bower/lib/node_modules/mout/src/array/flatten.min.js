define(["../lang/isArray","./append"],function(isArray,append){function flattenTo(arr,result,level){if(level===0){append(result,arr);return result}var value,i=-1,len=arr.length;while(++i<len){value=arr[i];if(isArray(value)){flattenTo(value,result,level-1)}else{result.push(value)}}return result}function flatten(arr,level){if(arr==null){return[]}level=level==null?-1:level;return flattenTo(arr,[],level)}return flatten});