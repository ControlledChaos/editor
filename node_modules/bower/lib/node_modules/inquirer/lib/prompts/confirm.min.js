var _=require("lodash");var util=require("util");var chalk=require("chalk");var Base=require("./base");var observe=require("../utils/events");module.exports=Prompt;function Prompt(){Base.apply(this,arguments);var rawDefault=true;_.extend(this.opt,{filter:function(input){var value=rawDefault;if(input!=null&&input!==""){value=/^y(es)?/i.test(input)}return value}.bind(this)});if(_.isBoolean(this.opt.default)){rawDefault=this.opt.default}this.opt.default=rawDefault?"Y/n":"y/N";return this}util.inherits(Prompt,Base);Prompt.prototype._run=function(cb){this.done=cb;var events=observe(this.rl);events.keypress.takeUntil(events.line).forEach(this.onKeypress.bind(this));events.line.take(1).forEach(this.onEnd.bind(this));this.render();return this};Prompt.prototype.render=function(answer){var message=this.getQuestion();if(typeof answer==="boolean"){message+=chalk.cyan(answer?"Yes":"No")}else{message+=this.rl.line}this.screen.render(message);return this};Prompt.prototype.onEnd=function(input){this.status="answered";var output=this.opt.filter(input);this.render(output);this.screen.done();this.done(input)};Prompt.prototype.onKeypress=function(){this.render()};