function formatError(a,b){b=b||{};var c="",d=a.extract,e=[],f=function(a){return a};if(a.stack&&!a.type)return f(a.stack,"red");if(!a.hasOwnProperty("index")||!d)return a.stack||a.message;if("string"==typeof d[0]&&e.push(f(a.line-1+" "+d[0],"grey")),"string"==typeof d[1]){var g=a.line+" ";d[1]&&(g+=d[1].slice(0,a.column)+f(f(f(d[1][a.column],"bold")+d[1].slice(a.column+1),"red"),"inverse")),e.push(g)}return"string"==typeof d[2]&&e.push(f(a.line+1+" "+d[2],"grey")),e=e.join("\n")+f("","reset")+"\n",c+=f(a.type+"Error: "+a.message,"red"),a.filename&&(c+=f(" in ","red")+a.filename+f(" on line "+a.line+", column "+(a.column+1)+":","grey")),c+="\n"+e,a.callLine&&(c+=f("from ","red")+(a.filename||"")+"/n",c+=f(a.callLine,"grey")+" "+a.callExtract+"/n"),c}function writeError(a,b){b=b||{},b.silent||print(formatError(a,b))}function loadStyleSheet(a,b,c,d){var e=Math.max(name.lastIndexOf("/"),name.lastIndexOf("\\")),f=name.slice(0,e+1)+a.href,g=a.contents||{},h=readFile(f);h=h.replace(/^\xEF\xBB\xBF/,""),g[f]=h;var i=new less.Parser({paths:[a.href.replace(/[\w\.-]+$/,"")],contents:g});i.parse(h,function(c,e){if(c)return writeError(c);try{b(c,e,h,a,{local:!1,lastModified:0,remaining:d},f)}catch(c){writeError(c)}})}function writeFile(a,b){var c=new java.io.FileWriter(a),d=new java.io.BufferedWriter(c);d.write(b),d.close()}less.Parser.fileLoader=function(a,b,c,d){var e=a;b&&b.currentDirectory&&!/^\//.test(a)&&(e=less.modules.path.join(b.currentDirectory,a));var f=less.modules.path.dirname(e),g={currentDirectory:f+"/",filename:e};b?(g.entryPath=b.entryPath,g.rootpath=b.rootpath,g.rootFilename=b.rootFilename,g.relativeUrls=b.relativeUrls):(g.entryPath=f,g.rootpath=less.rootpath||f,g.rootFilename=e,g.relativeUrls=d.relativeUrls);var h=a.lastIndexOf("/");if(g.relativeUrls&&!/^(?:[a-z-]+:|\/)/.test(a)&&h!=-1){var i=a.slice(0,h+1);g.rootpath=g.rootpath+i}g.currentDirectory=f,g.filename=e;var j=null;try{j=readFile(e)}catch(k){return void c({type:"File",message:"'"+less.modules.path.basename(e)+"' wasn't found"})}try{c(null,j,e,g,{lastModified:0})}catch(k){c(k,null,e)}},function(a){var b,c={depends:!1,compress:!1,cleancss:!1,max_line_len:-1,optimization:1,silent:!1,verbose:!1,lint:!1,paths:[],color:!0,strictImports:!1,rootpath:"",relativeUrls:!1,ieCompat:!0,strictMath:!1,strictUnits:!1},d=!0,e=function(a,b){return!!b||(print(a+" option requires a parameter"),d=!1,!1)},f=function(a){var b=/^((on|t|true|y|yes)|(off|f|false|n|no))$/i.exec(a);return b?Boolean(b[2]):(print(" unable to parse "+a+" as a boolean. use one of on/t/true/y/yes/off/f/false/n/no"),d=!1,!1)},g="",h=!1;if(a=a.filter(function(a){var b=a.match(/^-I(.+)$/);if(b)return c.paths.push(b[1]),!1;if(b=a.match(/^--?([a-z][0-9a-z-]*)(?:=(.*))?$/i),!b)return a;switch(a=b[1]){case"v":case"version":console.log("lessc "+less.version.join(".")+" (LESS Compiler) [JavaScript]"),d=!1;break;case"verbose":c.verbose=!0;break;case"s":case"silent":c.silent=!0;break;case"l":case"lint":c.lint=!0;break;case"strict-imports":c.strictImports=!0;break;case"h":case"help":d=!1;break;case"x":case"compress":c.compress=!0;break;case"M":case"depends":c.depends=!0;break;case"yui-compress":g+="yui-compress option has been removed. assuming clean-css.",c.cleancss=!0;break;case"clean-css":c.cleancss=!0;break;case"max-line-len":e(a,b[2])&&(c.maxLineLen=parseInt(b[2],10),c.maxLineLen<=0&&(c.maxLineLen=-1));break;case"no-color":c.color=!1;break;case"no-ie-compat":c.ieCompat=!1;break;case"no-js":c.javascriptEnabled=!1;break;case"include-path":e(a,b[2])&&(c.paths=b[2].split(os.type().match(/Windows/)?";":":").map(function(a){if(a)return a}));break;case"O0":c.optimization=0;break;case"O1":c.optimization=1;break;case"O2":c.optimization=2;break;case"line-numbers":e(a,b[2])&&(c.dumpLineNumbers=b[2]);break;case"source-map":b[2]?c.sourceMap=b[2]:c.sourceMap=!0;break;case"source-map-rootpath":e(a,b[2])&&(c.sourceMapRootpath=b[2]);break;case"source-map-basepath":e(a,b[2])&&(c.sourceMapBasepath=b[2]);break;case"source-map-map-inline":h=!0,c.sourceMap=!0;break;case"source-map-less-inline":c.outputSourceFiles=!0;break;case"source-map-url":e(a,b[2])&&(c.sourceMapURL=b[2]);break;case"source-map-output-map-file":e(a,b[2])&&(c.writeSourceMap=function(a){writeFile(b[2],a)});break;case"rp":case"rootpath":e(a,b[2])&&(c.rootpath=b[2].replace(/\\/g,"/"));break;case"ru":case"relative-urls":c.relativeUrls=!0;break;case"sm":case"strict-math":e(a,b[2])&&(c.strictMath=f(b[2]));break;case"su":case"strict-units":e(a,b[2])&&(c.strictUnits=f(b[2]));break;default:console.log("invalid option "+a),d=!1}}),d){var i=a[0],j=a[1],k=a[1];if(j&&(c.sourceMapOutputFilename=j,g&&console.log(g)),c.sourceMap===!0){if(console.log("output: "+j),!j&&!h)return void console.log("the sourcemap option only has an optional filename if the css filename is given");c.sourceMapFullFilename=c.sourceMapOutputFilename+".map",c.sourceMap=less.modules.path.basename(c.sourceMapFullFilename)}else c.sourceMap&&(c.sourceMapOutputFilename=c.sourceMap);if(!i)return console.log("lessc: no inout files"),console.log(""),void(b=1);if(c.depends){if(!k)return void console.log("option --depends requires an output path to be specified");console.log(k+": ")}i||(console.log("No files present in the fileset"),quit(1));var l=null;try{l=readFile(i,"utf-8")}catch(m){console.log("lesscss: couldn't open file "+i),quit(1)}c.filename=i;var n;try{var o=new less.Parser(c);o.parse(l,function(a,b){a?(writeError(a,c),quit(1)):(n=b.toCSS(c),j?(writeFile(j,n),console.log("Written to "+j)):print(n),quit(0))})}catch(m){writeError(m,c),quit(1)}console.log("done")}}(arguments);